<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bulb + Welcome App</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@400;500;600&display=swap" rel="stylesheet">

<!-- GSAP -->
<script src="https://unpkg.com/gsap@3/dist/gsap.min.js"></script>
<script src="https://unpkg.com/gsap@3/dist/Draggable.min.js"></script>
<script src="https://unpkg.com/gsap@3/dist/MorphSVGPlugin.min.js"></script>

<style>
* { box-sizing: border-box; margin: 0; padding: 0; }

/* ================= BULB STATE ================= */
:root {
  --on: 0;
  --bg-off: #000000;
  --bg-on: #fff3b0;
  --cord: hsl(0, 0%, calc((60 - (var(--on) * 50)) * 1%));
}

body {
  min-height: 100vh;
  background: var(--bg-off);
  overflow: hidden;
  font-family: 'Montserrat', sans-serif;
  transition: background 0.4s ease;
}

html[style*="--on: 1"] body {
  background: var(--bg-on);
}

/* ================= OFF STATE TEXT (ALIGNED) ================= */
.off-text {
  position: fixed;
  inset: 0;

  display: flex;
  flex-direction: column;      /* stack lines */
  justify-content: center;
  align-items: center;

  font-family: 'Montserrat', sans-serif;
  font-size: 26px;
  font-weight: 500;
  color: #ffffff;

  text-align: center;
  line-height: 1.5;
  gap: 12px;

  pointer-events: none;
  opacity: 1;
  transition: opacity 0.4s ease;
  z-index: 20;
}

/* Hide when light ON */
html[style*="--on: 1"] .off-text {
  opacity: 0;
}

/* ================= WELCOME APP ================= */
#welcomeApp {
  position: fixed;
  inset: 0;
  display: none;
  z-index: 50;
}

/* PASSWORD */
.password-modal {
  position: absolute;
  inset: 0;
  background: rgba(255, 243, 176, 0.95);
  display: flex;
  justify-content: center;
  align-items: center;
}

.password-content {
  background: white;
  padding: 30px;
  border-radius: 20px;
  text-align: center;
  width: 90%;
  max-width: 400px;
  animation: bounceIn 1s forwards;
}

.password-content h2 {
  font-family: 'Dancing Script', cursive;
  font-size: 32px;
  color: #000000;
  margin-bottom: 20px;
}

.password-input {
  width: 100%;
  padding: 12px;
  border: 2px solid #ffe27a;
  border-radius: 10px;
  font-size: 16px;
  text-align: center;
  margin-bottom: 15px;
}

.submit-btn {
  background: #000000;
  color: white;
  border: none;
  padding: 12px 25px;
  border-radius: 10px;
  cursor: pointer;
}

/* WELCOME SCREEN */
.welcome-screen {
  position: absolute;
  inset: 0;
  background: linear-gradient(135deg, #fff3b0, #ffe27a);
  display: none;
  justify-content: center;
  align-items: center;
}

.welcome-message {
  font-family: 'Dancing Script', cursive;
  font-size: 48px;
  color: #000;
  animation: pulse 2s infinite, float 3s ease-in-out infinite;
}

/* ================= ROPE ================= */
.toggle-scene {
  position: fixed;
  top: 0;
  right: 1px;
  height: 100vh;
  z-index: 100;
}

.toggle-scene__cord {
  stroke: var(--cord);
  stroke-width: 6;
  fill: none;
}

.toggle-scene__cord:nth-of-type(1),
.toggle-scene__cord:nth-of-type(2),
.toggle-scene__cord:nth-of-type(3),
.toggle-scene__cord:nth-of-type(4),
.toggle-scene__cord:nth-of-type(5) {
  display: none;
}

.toggle-scene__cord-end {
  stroke: var(--cord);
  fill: var(--cord);
}

.toggle-scene__dummy-cord {
  stroke-width: 6;
  stroke: var(--cord);
}

/* ================= ANIMATIONS ================= */
@keyframes bounceIn {
  0% { transform: scale(0.8); opacity: 0; }
  100% { transform: scale(1); opacity: 1; }
}
@keyframes pulse {
  0%,100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}
@keyframes float {
  0%,100% { transform: translateY(0); }
  50% { transform: translateY(-12px); }
}
</style>
</head>

<body>

<!-- OFF STATE TEXT -->
<div class="off-text">
  <div style="font-size:18px; opacity:0.7;">
    Press F11 button for clean visuals
  </div>
  <div>
    Oh looks like the bulb is off. Pull the string to turn on the light
  </div>
</div>

<!-- ================= WELCOME APP ================= -->
<div id="welcomeApp">
  <div class="password-modal" id="passwordModal">
    <div class="password-content">
      <h2>32 pallu baita petti navvedhi evru???</h2>
      <input type="password" class="password-input" id="passwordInput" placeholder="Our special word...">
      <button class="submit-btn" id="submitPassword">Enter</button>
    </div>
  </div>

  <div class="welcome-screen" id="welcomeScreen">
    <h1 class="welcome-message">edho chesam chdu</h1>
  </div>
</div>

<!-- ================= ROPE SVG ================= -->
<svg class="toggle-scene"
  xmlns="http://www.w3.org/2000/svg"
  viewBox="0 0 200 450"
  preserveAspectRatio="xMidYMin">

  <defs>
    <marker id="a" orient="auto" overflow="visible">
      <path class="toggle-scene__cord-end"
        d="M.98 0a1 1 0 11-2 0 1 1 0 012 0z"/>
    </marker>
  </defs>

  <g class="toggle-scene__cords">
    <path class="toggle-scene__cord" marker-end="url(#a)" d="M100 0 V200"/>
    <g class="toggle-scene__dummy-cord">
      <line x1="100" y1="0" x2="100" y2="300" marker-end="url(#a)"/>
    </g>
    <circle class="toggle-scene__hit-spot" cx="100" cy="300" r="50" fill="transparent"/>
  </g>
</svg>

<script>
/* ================= ROPE LOGIC ================= */
const { gsap, Draggable, MorphSVGPlugin } = window;
gsap.registerPlugin(Draggable, MorphSVGPlugin);

let startX, startY;
const STATE = { ON: false };

const HIT = document.querySelector('.toggle-scene__hit-spot');
const DUMMY_CORD = document.querySelector('.toggle-scene__dummy-cord line');
const PROXY = document.createElement('div');
const ENDX = DUMMY_CORD.getAttribute('x2');
const ENDY = DUMMY_CORD.getAttribute('y2');

gsap.set(PROXY, { x: ENDX, y: ENDY });

Draggable.create(PROXY, {
  trigger: HIT,
  type: 'x,y',
  onPress(e) {
    startX = e.x; startY = e.y;
  },
  onDrag() {
    gsap.set(DUMMY_CORD, { attr: { x2: this.x, y2: this.y } });
  },
  onRelease(e) {
    const dist = Math.hypot(e.x - startX, e.y - startY);
    gsap.to(DUMMY_CORD, {
      attr: { x2: ENDX, y2: ENDY },
      duration: 0.12,
      onComplete() {
        if (dist > 50) toggleBulb();
      }
    });
  }
});

/* ================= VISIBILITY GLUE ================= */
const app = document.getElementById("welcomeApp");
const modal = document.getElementById("passwordModal");
const welcome = document.getElementById("welcomeScreen");
const input = document.getElementById("passwordInput");
const button = document.getElementById("submitPassword");

function toggleBulb() {
  STATE.ON = !STATE.ON;
  gsap.set(document.documentElement, { '--on': STATE.ON ? 1 : 0 });

  if (STATE.ON) {
    app.style.display = "block";
  } else {
    app.style.display = "none";
    modal.style.display = "flex";
    modal.style.opacity = "1";
    welcome.style.display = "none";
    input.value = "";
  }
}

/* ================= PASSWORD LOGIC ================= */
button.addEventListener("click", () => {
  if (input.value.toLowerCase() === "nene") {
    modal.style.opacity = "0";
    setTimeout(() => {
      modal.style.display = "none";
      welcome.style.display = "flex";

      setTimeout(() => {
        window.location.href = "/public/snow.html";
      }, 5000);

    }, 500);
  } else {
    input.value = "";
  }
});
</script>

</body>
</html>
